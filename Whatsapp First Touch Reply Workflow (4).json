{
  "name": "Whatsapp First Touch Reply Workflow",
  "nodes": [
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={ \"success\": true }",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.2,
      "position": [
        272,
        -16
      ],
      "id": "895208b2-5c5e-4edc-a624-e212cd79d26c",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "ac5e2f21-bde4-477b-8889-26b827cbec66",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        0,
        -16
      ],
      "id": "e480bbea-25c1-4d0c-aa21-5a2003d7ca53",
      "name": "Webhook",
      "webhookId": "ac5e2f21-bde4-477b-8889-26b827cbec66"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.1,
      "position": [
        848,
        144
      ],
      "id": "1cadbd72-efd0-4a28-9adb-f621e7b12d9f",
      "name": "Merge",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "filterByFormula": "={{ \"{Number} = '\" + ($json.body.entry[0].changes[0].value.statuses ? $json.body.entry[0].changes[0].value.statuses[0].recipient_id : $json.body.entry[0].changes[0].value.messages[0].from) + \"'\" }}",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        528,
        192
      ],
      "id": "484d23b7-fa10-4d87-915d-49f03656f762",
      "name": "Search records1",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{$json.number}}",
            "Reply Received": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }} - {{$json.message_text}}",
            "Status": "REPLIED"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Full Name ",
              "displayName": "Full Name ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Current_Stage",
              "displayName": "Current_Stage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal ID",
              "displayName": "Deal ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Lead Email",
              "displayName": "Lead Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Form Submitted",
              "displayName": "Form Submitted",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deal Owner",
              "displayName": "Deal Owner",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Number",
              "displayName": "Deal Owner Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Email",
              "displayName": "Deal Owner Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner ID",
              "displayName": "Deal Owner ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent",
              "displayName": "Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Delivered",
              "displayName": "Delivered",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Read",
              "displayName": "Read",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Reply Received",
              "displayName": "Reply Received",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Template Used",
              "displayName": "Template Used",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "whatsapp_first_touch_1 ",
                  "value": "whatsapp_first_touch_1 "
                },
                {
                  "name": "whatsapp_first_touch_with_sdr_1 ",
                  "value": "whatsapp_first_touch_with_sdr_1 "
                },
                {
                  "name": "2_whatsapp_first_touch_with_sdr",
                  "value": "2_whatsapp_first_touch_with_sdr"
                },
                {
                  "name": "3_whatsapp_first_touch_with_sdr",
                  "value": "3_whatsapp_first_touch_with_sdr"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent Message ",
              "displayName": "Sent Message ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Message",
              "displayName": "Error Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Calculation",
              "displayName": "Calculation",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2496,
        -256
      ],
      "id": "769313c2-f11c-4d13-9902-4b198d8dcae4",
      "name": "Sent - Whatsapp First Touch",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tbl0k9l6TuEl3SiWr",
          "mode": "list",
          "cachedResultName": "Reply - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tbl0k9l6TuEl3SiWr"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{$json.number}}",
            "Name": "={{$json.name}}",
            "Reply Received": "={{$json.message_text}}",
            "Select": "Received",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Reply Received",
              "displayName": "Reply Received",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2496,
        -480
      ],
      "id": "a3bcfb2a-3096-483b-870d-0b7e82c7f689",
      "name": "Reply - Whatsapp First Touch",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{$json.number}}",
            "Name": "={{$json.name}}",
            "Select": "Received",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{$json.message_text}}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2496,
        -704
      ],
      "id": "e165c16e-18bc-48f8-8b86-fba06509e4ff",
      "name": "Master - WhatsApp First Touch",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Name": "={{$json.name}}",
            "Select": "Received",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{$json.message_text}}",
            "Status": "DELIVERED"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        3056,
        304
      ],
      "id": "687c6ee3-488b-44d2-9c7c-c4a806917b21",
      "name": "Master - WhatsApp First Touch1",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Name": "={{$json.name}}",
            "Select": "Sent",
            "Timestamp": "={{ $now.format(\"DD HH:mm\") }}",
            "Message": "={{$json.message_text}}",
            "Status": "READ"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2944,
        528
      ],
      "id": "8cbdaad5-c54f-4be4-99ec-3eb208b70c11",
      "name": "Master - WhatsApp First Touch2",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Name": "={{$json.name}}",
            "Select": "Sent",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{$json.message_text}}",
            "Status": "FAILED"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        3040,
        752
      ],
      "id": "3345e1cf-4051-4812-b9ed-1d0ea3e739a8",
      "name": "Master - WhatsApp First Touch3",
      "executeOnce": false,
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Name": "={{$json.name}}",
            "Select": "Sent",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{$json.message_text}}",
            "Status": "UNDELIVERABLE"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        3520,
        944
      ],
      "id": "63a0cebf-8e71-4ca6-ab82-7b1b03e7a462",
      "name": "Master - WhatsApp First Touch4",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Name": "={{$json.name}}",
            "Select": "Received",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{$json.message_text}}",
            "Status": "SENT"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        3056,
        80
      ],
      "id": "dd874e5c-820a-46e5-b71a-59ecb1c52867",
      "name": "Master - WhatsApp First Touch5",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a10e6f55-759c-454f-aacb-0ec998991050",
              "leftValue": "={{ $json.status === \"failed\" }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2320,
        752
      ],
      "id": "614dd0fa-8e60-4fb7-a433-c214b8e11d36",
      "name": "If \"FAILED\"2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a10e6f55-759c-454f-aacb-0ec998991050",
              "leftValue": "={{ $json.status === \"read\" }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2320,
        544
      ],
      "id": "4a4f8015-95ed-40e3-80ca-fdd61ddbb8c8",
      "name": "If \"READ\"2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a10e6f55-759c-454f-aacb-0ec998991050",
              "leftValue": "={{ $json.status === \"delivered\" }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2320,
        352
      ],
      "id": "a8d6a0a5-aee8-4982-aa2f-ba07c6152cf9",
      "name": "If \"DELIVERED\"2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "45a98321-cf91-4618-97bc-c604136bdf13",
              "leftValue": "={{ $json.status === \"sent\" }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2320,
        128
      ],
      "id": "ad6e6d9e-98b2-4317-bfc1-2a6ccefd9799",
      "name": "If \"SENT\"2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "977b82c7-634a-47fc-9160-72c6418a4168",
              "name": "message_id",
              "value": "={{ $json.body.entry[0].changes[0].value.statuses[0].id }}",
              "type": "string"
            },
            {
              "id": "e43b0d71-7ab4-4751-91f0-bdbdd6ec77b0",
              "name": "status",
              "value": "={{$json.body.entry[0].changes[0].value.statuses[0].status}}",
              "type": "string"
            },
            {
              "id": "2bb57a1e-9197-4fbc-9f78-0071271236a8",
              "name": "recipient_id",
              "value": "={{ $json.body.entry[0].changes[0].value.statuses[0].recipient_id }}",
              "type": "string"
            },
            {
              "id": "475b6c24-e111-47d4-bf77-c1bfafbba6b4",
              "name": "timestamp",
              "value": "={{ $json.body.entry[0].changes[0].value.statuses[0].timestamp }}",
              "type": "string"
            },
            {
              "id": "7e3bfb30-16e9-4a3a-9747-b5f0bf31a71d",
              "name": "error_code",
              "value": "={{ $json.body.entry[0].changes[0].value.statuses[0].errors ? $json.body.entry[0].changes[0].value.statuses[0].errors[0].code : null }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2048,
        432
      ],
      "id": "d5c5153f-0d7f-475f-924c-831b2ecc8515",
      "name": "Extract Status Details2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "aba3f6db-0130-40e8-86ef-d01ae3485bb5",
              "name": "name",
              "value": "={{ $json.body.entry[0].changes[0].value.contacts[0].profile.name }}",
              "type": "string"
            },
            {
              "id": "5f1c4c99-a7a3-4b02-a480-de543bbc59af",
              "name": "number",
              "value": "={{ $json.body.entry[0].changes[0].value.contacts[0].wa_id }}",
              "type": "string"
            },
            {
              "id": "26bf46f1-7764-4da1-8b22-6af60435f00a",
              "name": "message_text",
              "value": "={{ $json.body.entry[0].changes[0].value.messages[0].text.body }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2048,
        -384
      ],
      "id": "2e5c7c50-132c-437e-9c9e-137b20a8fe6f",
      "name": "Extract Message Data2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "4969d083-8d97-48ac-af7b-d8b9e86e9d98",
              "leftValue": "={{$json.body.entry[0].changes[0].value.messages !== undefined}}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1648,
        48
      ],
      "id": "a6c55934-4c5d-4876-aa54-3d70e9fc819b",
      "name": "If - Message or Status2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "fe12286c-8893-4a32-a3df-2214d52cf190",
              "leftValue": "={{ $json.error_code === '131049' }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2576,
        768
      ],
      "id": "b8ce38cb-9766-49f5-822b-5a5621b05f36",
      "name": "If RESEND2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "fe12286c-8893-4a32-a3df-2214d52cf190",
              "leftValue": "={{ $json.error_code === '131026' }}",
              "rightValue": true,
              "operator": {
                "type": "boolean",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2800,
        928
      ],
      "id": "814fc9e1-0bce-4baa-8243-136797b2a15f",
      "name": "If UNDELIVERABLE2"
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Status": "SENT",
            "Sent": "=Sent at {{ $now.format('DD HH:mm') }}"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Full Name ",
              "displayName": "Full Name ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Current_Stage",
              "displayName": "Current_Stage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal ID",
              "displayName": "Deal ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Lead Email",
              "displayName": "Lead Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Form Submitted",
              "displayName": "Form Submitted",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deal Owner",
              "displayName": "Deal Owner",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Number",
              "displayName": "Deal Owner Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Email",
              "displayName": "Deal Owner Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner ID",
              "displayName": "Deal Owner ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent",
              "displayName": "Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Delivered",
              "displayName": "Delivered",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Read",
              "displayName": "Read",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Reply Received",
              "displayName": "Reply Received",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Template Used",
              "displayName": "Template Used",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "whatsapp_first_touch_1 ",
                  "value": "whatsapp_first_touch_1 "
                },
                {
                  "name": "whatsapp_first_touch_with_sdr_1 ",
                  "value": "whatsapp_first_touch_with_sdr_1 "
                },
                {
                  "name": "2_whatsapp_first_touch_with_sdr",
                  "value": "2_whatsapp_first_touch_with_sdr"
                },
                {
                  "name": "3_whatsapp_first_touch_with_sdr",
                  "value": "3_whatsapp_first_touch_with_sdr"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent Message ",
              "displayName": "Sent Message ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Message",
              "displayName": "Error Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Calculation",
              "displayName": "Calculation",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2752,
        -32
      ],
      "id": "2c04f14a-b09e-4391-a3d5-063bdfbfd144",
      "name": "Update SENT2",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Status": "DELIVERED",
            "Delivered": "=Delivered at {{ $now.format('DD HH:mm') }}"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Full Name ",
              "displayName": "Full Name ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Current_Stage",
              "displayName": "Current_Stage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal ID",
              "displayName": "Deal ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Lead Email",
              "displayName": "Lead Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Form Submitted",
              "displayName": "Form Submitted",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deal Owner",
              "displayName": "Deal Owner",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Number",
              "displayName": "Deal Owner Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Email",
              "displayName": "Deal Owner Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner ID",
              "displayName": "Deal Owner ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent",
              "displayName": "Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Delivered",
              "displayName": "Delivered",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Read",
              "displayName": "Read",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Reply Received",
              "displayName": "Reply Received",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Template Used",
              "displayName": "Template Used",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "whatsapp_first_touch_1 ",
                  "value": "whatsapp_first_touch_1 "
                },
                {
                  "name": "whatsapp_first_touch_with_sdr_1 ",
                  "value": "whatsapp_first_touch_with_sdr_1 "
                },
                {
                  "name": "2_whatsapp_first_touch_with_sdr",
                  "value": "2_whatsapp_first_touch_with_sdr"
                },
                {
                  "name": "3_whatsapp_first_touch_with_sdr",
                  "value": "3_whatsapp_first_touch_with_sdr"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent Message ",
              "displayName": "Sent Message ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Message",
              "displayName": "Error Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Calculation",
              "displayName": "Calculation",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2752,
        224
      ],
      "id": "6d691dee-bc58-4de3-9c08-e2a973b72022",
      "name": "Update DELIVERED2",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Status": "READ",
            "Read": "=Read at {{ $now.format('DD HH:mm') }}"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Full Name ",
              "displayName": "Full Name ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Current_Stage",
              "displayName": "Current_Stage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal ID",
              "displayName": "Deal ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Lead Email",
              "displayName": "Lead Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Form Submitted",
              "displayName": "Form Submitted",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deal Owner",
              "displayName": "Deal Owner",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Number",
              "displayName": "Deal Owner Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Email",
              "displayName": "Deal Owner Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner ID",
              "displayName": "Deal Owner ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent",
              "displayName": "Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Delivered",
              "displayName": "Delivered",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Read",
              "displayName": "Read",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Reply Received",
              "displayName": "Reply Received",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Template Used",
              "displayName": "Template Used",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "whatsapp_first_touch_1 ",
                  "value": "whatsapp_first_touch_1 "
                },
                {
                  "name": "whatsapp_first_touch_with_sdr_1 ",
                  "value": "whatsapp_first_touch_with_sdr_1 "
                },
                {
                  "name": "2_whatsapp_first_touch_with_sdr",
                  "value": "2_whatsapp_first_touch_with_sdr"
                },
                {
                  "name": "3_whatsapp_first_touch_with_sdr",
                  "value": "3_whatsapp_first_touch_with_sdr"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent Message ",
              "displayName": "Sent Message ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Message",
              "displayName": "Error Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Calculation",
              "displayName": "Calculation",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2752,
        416
      ],
      "id": "a95a81a3-729f-49c4-ad3d-692ef3a90f3f",
      "name": "Update READ2",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Status": "FAILED",
            "Error Message": "=Failed at {{ $now.format('DD HH:mm') }}"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Full Name ",
              "displayName": "Full Name ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Current_Stage",
              "displayName": "Current_Stage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal ID",
              "displayName": "Deal ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Lead Email",
              "displayName": "Lead Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Form Submitted",
              "displayName": "Form Submitted",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deal Owner",
              "displayName": "Deal Owner",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Number",
              "displayName": "Deal Owner Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Email",
              "displayName": "Deal Owner Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner ID",
              "displayName": "Deal Owner ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent",
              "displayName": "Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Delivered",
              "displayName": "Delivered",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Read",
              "displayName": "Read",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Reply Received",
              "displayName": "Reply Received",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Template Used",
              "displayName": "Template Used",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "whatsapp_first_touch_1 ",
                  "value": "whatsapp_first_touch_1 "
                },
                {
                  "name": "whatsapp_first_touch_with_sdr_1 ",
                  "value": "whatsapp_first_touch_with_sdr_1 "
                },
                {
                  "name": "2_whatsapp_first_touch_with_sdr",
                  "value": "2_whatsapp_first_touch_with_sdr"
                },
                {
                  "name": "3_whatsapp_first_touch_with_sdr",
                  "value": "3_whatsapp_first_touch_with_sdr"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent Message ",
              "displayName": "Sent Message ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Message",
              "displayName": "Error Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Calculation",
              "displayName": "Calculation",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        2768,
        672
      ],
      "id": "e9fc2878-6d73-4784-baa8-69d8da6afab2",
      "name": "Update FAILED2",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.recipient_id }}",
            "Status": "UNDELIVERABLE",
            "Error Message": "=Failed at {{ $now.format('DD HH:mm') }}"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Full Name ",
              "displayName": "Full Name ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Current_Stage",
              "displayName": "Current_Stage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal ID",
              "displayName": "Deal ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Lead Email",
              "displayName": "Lead Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Form Submitted",
              "displayName": "Form Submitted",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deal Owner",
              "displayName": "Deal Owner",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Number",
              "displayName": "Deal Owner Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner Email",
              "displayName": "Deal Owner Email",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Deal Owner ID",
              "displayName": "Deal Owner ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent",
              "displayName": "Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Delivered",
              "displayName": "Delivered",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Read",
              "displayName": "Read",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Reply Received",
              "displayName": "Reply Received",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Template Used",
              "displayName": "Template Used",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "whatsapp_first_touch_1 ",
                  "value": "whatsapp_first_touch_1 "
                },
                {
                  "name": "whatsapp_first_touch_with_sdr_1 ",
                  "value": "whatsapp_first_touch_with_sdr_1 "
                },
                {
                  "name": "2_whatsapp_first_touch_with_sdr",
                  "value": "2_whatsapp_first_touch_with_sdr"
                },
                {
                  "name": "3_whatsapp_first_touch_with_sdr",
                  "value": "3_whatsapp_first_touch_with_sdr"
                }
              ],
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Sent Message ",
              "displayName": "Sent Message ",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Error Message",
              "displayName": "Error Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Calculation",
              "displayName": "Calculation",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        3296,
        832
      ],
      "id": "c9b7c171-1444-4590-a58e-25fd58d58386",
      "name": "Update FAILED3",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5d7206a5-0203-4af7-b01c-97b9f5f545be",
              "leftValue": "={{ $json.Current_Stage }}",
              "rightValue": "First Touch",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        1072,
        64
      ],
      "id": "61398976-c38e-4990-979f-6f361d992b29",
      "name": "If - First Touch"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "40837d24-31f0-4e67-8f11-668d40e8b245",
              "name": "meet_url",
              "value": "={{ $json.body.teams_url }}",
              "type": "string"
            },
            {
              "id": "1ed550d6-e5f8-4fdf-b679-50136a989ec8",
              "name": "start_time",
              "value": "={{ $json.body.start_time }}",
              "type": "string"
            },
            {
              "id": "0b6818e6-0600-4ec9-854c-ad11609a981b",
              "name": "sdr_name",
              "value": "={{ $json.body.sdr_name }}",
              "type": "string"
            },
            {
              "id": "34743d8e-6395-469d-b2a2-fca9b4290862",
              "name": "sdr_number",
              "value": "={{ $json.body.sdr_number }}",
              "type": "string"
            },
            {
              "id": "edde3fe4-b053-4a05-a6d5-ece6b4dce99c",
              "name": "lead_number",
              "value": "={{ $json.body.lead_number }}",
              "type": "string"
            },
            {
              "id": "8e410e54-0301-46b3-94a0-8976cc576a61",
              "name": "attendee_name",
              "value": "={{ $json.body.attendee_name }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        6080,
        -912
      ],
      "id": "531bef44-4c48-44ae-83bf-04c6cedf5f39",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# WhatsApp SDR Prompt for AI Accountant\n\n# 🔴🔴🔴 CRITICAL SYSTEM RULE - READ THIS FIRST 🔴🔴🔴\n\n## YOU ARE PART OF A TWO-PART SYSTEM:\n1. **YOU** validate times and return JSON commands\n2. **EXTERNAL SYSTEM** creates meetings and sends links based on your commands\n\n## WHEN USER SAYS \"YES\" TO CONFIRM:\n- Return `{\"action\": \"SCHEDULE\", ...}` → Meeting gets created\n- Return `{\"action\": \"UPDATE\", ...}` → Meeting gets updated\n- Return `{\"action\": \"RESPOND\", ...}` → NO MEETING, customer gets nothing\n\n## NEVER SAY \"Your demo is confirmed\" - YOU CANNOT CONFIRM ANYTHING!\n## ONLY THE EXTERNAL SYSTEM CAN CONFIRM BY CREATING THE MEETING!\n\n## IF YOU SEE THIS PATTERN:\n- SDR: \"Reply YES to confirm\"\n- User: \"Yes\"\n\n## YOUR OUTPUT MUST BE:\n```json\n{\n  \"action\": \"SCHEDULE\",\n  \"start_time\": \"[time from proposal]\",\n  ...\n}\n```\n\n## NOT THIS - THIS BREAKS EVERYTHING:\n```json\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"Perfect! Your demo is confirmed...\"\n}\n```\n\n---\n\n## 1. ROLE & IDENTITY\n\nYou are an AI assistant helping potential customers learn about AI Accountant. You work alongside human account managers to qualify leads and schedule demos.\n\n**Identity Rules:**\n- Be transparent that you're an AI assistant when directly asked\n- You support the human sales team but don't pretend to be human\n- Focus on being helpful rather than your identity\n\n**Example Identity Responses:**\n- If asked \"Are you a bot?\": \"Yes, I'm an AI assistant helping you learn about AI Accountant. I can answer questions and help schedule a demo with our team.\"\n- If asked \"Who are you?\": \"I'm part of the AI Accountant team, here to help you understand how we can automate your bookkeeping.\"\n\n## 2. CONVERSATION CONTEXT\n\nInitial Outreach Already Sent:\nThe lead has already received this first message from us:\n\"Hey! I am from AI Accountant. We got your query. \nSDR Name, (Account Manager, +91 9999999999) will be your go-to person from here on.\nCan you tell me a time when we can schedule a 15-minute demo call with you?\"\n\nIMPORTANT: You are now handling their RESPONSE to this initial message. They've already been asked about scheduling, so adapt your approach based on their reply.\n\n**Lead Information:**\n- Name: {{ $json.leadName }}\n- Number: {{ $json.leadNumber }}\n- Total Messages: {{ $json.messageCount }}\n- Latest Message: \"{{ $json.latestMessage }}\" (at {{ $json.latestTimestamp }})\n\n**Conversation History:**\n{{ $json.conversationContext }}\n\n**CRITICAL:** Respond ONLY to the latest message. Use history for context but address the most recent message directly.\n\n**CRITICAL CONTEXT REQUIRED:**\n- Current Date: {{ $json.currentDate }}\n- Current Day: {{ $json.currentDayOfWeek }}  // e.g., \"Saturday\", \"Monday\"\n- Current Time: {{ $json.currentTime }} IST\n\n**USE THIS TO VALIDATE:**\n- NEVER schedule on Saturday/Sunday\n- When user says \"today\", check currentDayOfWeek first\n- When user says \"tomorrow\", calculate what day that would be\n\n## 2.5. CONTEXT DETECTION RULES\n\n**BEFORE processing any user message, determine meeting status:**\n\n### Meeting Status Detection:\n\n**MEETING EXISTS - Scan conversation history for these indicators:**\n- \"Your demo has been scheduled for\"\n- \"teams.microsoft.com\" or meeting links\n- \"Looking forward to our session\"\n- \"join the session using this link\"\n- \"From here on, [Name] will be your point of contact\"\n- External system confirmation messages\n\n**NO MEETING EXISTS - Indicators:**\n- No confirmation messages in history\n- Only scheduling discussions, no confirmations\n- First-time scheduling conversations\n\n### Context-Based Actions:\n\n**If Meeting Confirmed + Time Change Request:**\n- Use UPDATE action\n- Same validation rules apply (weekdays, 9am-6pm, etc.)\n\n**If No Meeting + Time Request:**\n- Use SCHEDULE action\n- Follow existing scheduling workflow\n\n**If Context Unclear:**\n- Default to ESCALATE with reason: \"Meeting status unclear\"\n\n## 3. DECISION FRAMEWORK\n\n### 🔴 ABSOLUTE CRITICAL RULE #1 - VIOLATING THIS BREAKS EVERYTHING 🔴\n\n**WHEN USER SAYS \"YES\" or \"yes\" or \"Yes\" or ANY VARIATION:**\n1. CHECK: Did your last message say \"Reply YES to confirm\"?\n2. IF YES → **MUST RETURN SCHEDULE/UPDATE JSON**\n3. **NEVER EVER RETURN RESPOND WITH CONFIRMATION TEXT**\n\n**THIS IS WRONG AND BREAKS THE SYSTEM:**\nUser: \"YES\"\nYou return: {\"action\": \"RESPOND\", \"message\": \"Perfect! Your demo is confirmed...\"}\n❌❌❌ THIS WILL FAIL - NO MEETING WILL BE CREATED ❌❌❌\n\n**THIS IS THE ONLY CORRECT RESPONSE:**\nUser: \"YES\" \nYou return: {\"action\": \"SCHEDULE\", \"start_time\": \"...\", ...}\n✅ ONLY THIS CREATES THE MEETING ✅\n\nIF YOU SEND A CONFIRMATION MESSAGE, THE CUSTOMER GETS NO MEETING LINK!\n\n### SCHEDULING RULES\n\n#### Valid Demo Times:\n- **ONLY Monday-Friday** (NO weekends ever)\n- **ONLY 9:00 AM - 6:00 PM IST**\n- Not on public holidays\n- Minimum 60 minutes from current time\n- Maximum 2 weeks (14 days) in advance\n\n#### SIMPLIFIED SCHEDULING WORKFLOW:\n\n##### STEP 1 - When user suggests ANY time:\n**FIRST CHECK DAY OF WEEK:**\n- Saturday or Sunday? → IMMEDIATELY return RESPOND suggesting Monday\n- Public holiday? → Return RESPOND suggesting next working day\n- More than 2 weeks away? → Return RESPOND suggesting sooner\n\n**THEN CHECK TIME (only if valid weekday):**\n- Before 9am or after 6pm? → Return RESPOND with valid time\n- Valid time (9am-6pm)? → Return RESPOND with: \n  - Exact date/time confirmation\n  - \"Reply YES to confirm\" at the end\n\n##### STEP 2 - When user says YES/Sure/Ok/Confirm:\n**CHECK ONLY THE LAST AI MESSAGE:**\n- Contains \"Reply YES to confirm\"? → Return SCHEDULE/UPDATE JSON\n- No confirmation request found? → Return RESPOND asking what they're confirming\n\n**⚠️ CRITICAL: NEVER send \"demo confirmed\" messages - the system handles confirmations**\n\n### SIMPLE DECISION TREE\n\n**Process user messages in this order:**\n\n0. **CONTEXT CHECK - Does meeting already exist?**\n   → Scan conversation history for: \"Your demo has been scheduled\", meeting links\n   → MEETING EXISTS = TRUE: Time changes use UPDATE\n   → MEETING EXISTS = FALSE: Time requests use SCHEDULE\n\n1. **User says YES/yes/Yes or any affirmative?**\n   \n   **STOP! CRITICAL CHECK:**\n   → Meeting exists + last message said \"Reply YES to confirm update\"? → UPDATE\n   → No meeting + last message said \"Reply YES to confirm\"? → SCHEDULE\n   - Your last message contains \"Reply YES to confirm\"? \n   - **→ IMMEDIATELY RETURN SCHEDULE/UPDATE JSON**\n   - **→ DO NOT WRITE ANY MESSAGE**\n   - **→ DO NOT SAY \"DEMO CONFIRMED\"**\n   - **→ JUST RETURN THE SCHEDULE/UPDATE JSON**\n   \n   Example of CORRECT behavior:\n   - You said: \"I can schedule for Monday at 11:00 AM. Reply YES to confirm\"\n   - User says: \"YES\"\n   - You return: {\"action\": \"SCHEDULE\", \"start_time\": \"2025-08-11T11:00:00+05:30\", ...}\n   - NOT: {\"action\": \"RESPOND\", \"message\": \"Perfect! Your demo is confirmed...\"}\n\n1.5. **User requests time change for existing meeting?**\n   → Meeting confirmed in history + time change language? → Use UPDATE logic\n   → Weekend or invalid time? → Return RESPOND (suggest valid time)\n   → Valid time? → Return UPDATE JSON\n\n2. **User provides date/time?**\n   → Parse the date/time from their message\n   → At least 60 minutes from now\n   → Different from your last proposal? Treat as NEW suggestion\n   → Weekend? Return RESPOND (suggest Monday-Friday)\n   → Outside 9am-6pm? Return RESPOND (suggest valid hours)\n   → Too far ahead (>14 days)? Return RESPOND (suggest sooner)\n   → Valid? Return RESPOND with \"I can schedule for [DATE/TIME]. Reply YES to confirm\"\n\n3. **User asks about product/features?**\n   → Return RESPOND with helpful answer\n   → Include soft scheduling ask if showing interest\n\n4. **User needs human help?**\n   → Angry or frustrated? Return ESCALATE\n   → Complex technical question? Return ESCALATE  \n   → Pricing negotiation? Return ESCALATE\n   → Otherwise, try to help with RESPOND first\n\n5. **Default (greetings, unclear, general chat)?**\n   → Return RESPOND with appropriate message\n   → Guide towards scheduling if relevant\n\n### State Tracking:\n\n### SCHEDULING CONFIRMATION RULES:\n\n**When user says ANY affirmative** (YES/Yes/yes/Sure/Ok/Okay/Confirm/Perfect/Sounds good/Book it):\n\n1. **Find the MOST RECENT proposal from YOU:**\n   - Look at YOUR last message first\n   - If it contains \"Reply YES to confirm\" → SCHEDULE/UPDATE with that time\n   - If not, scan backwards through YOUR messages (not user's)\n   - Find the most recent proposal that hasn't been acted on\n   - Found one? → SCHEDULE/UPDATE with that time\n   - Found none? → RESPOND asking for clarification\n\n2. **CRITICAL - What to Return:**\n   - SCHEDULE = External system books meeting & sends link\n   - UPDATE = External system updates meeting & sends link\n   - RESPOND = Just sends message, NO booking happens\n\n**NEVER DO THIS:**\n- Return RESPOND with \"Your demo is confirmed\" \n- Mention \"sending you the link\"\n- Say \"demo scheduled successfully\"\n\nThe external system handles ALL confirmations and link generation.\n\n**Proposal Detection Patterns:**\n- \"I can schedule your demo for [TIME]\"\n- \"demo for today at [TIME]\"\n- \"demo for tomorrow at [TIME]\" \n- \"demo on [DAY] at [TIME]\"\n- Any message ending with \"Reply YES to confirm\"\n\n**Update Detection Patterns:**\n- \"Can we change the time to...\"\n- \"Update to...\"  \n- \"Move the meeting to...\"\n- \"Change it to...\"\n- \"Update the time to...\"\n- \"Shift it to...\"\n- \"Can we do [time] instead?\"\n- \"Actually, let's do [time]\"\n\n**Handle Intermediate Messages:**\nUser might send OTHER messages between your proposal and their confirmation:\n- Clarifications: \"What's the agenda?\"\n- Questions: \"Will it be on Zoom?\"\n- Comments: \"Sounds good, let me check\"\n\n**These intermediate messages DO NOT invalidate your pending proposal.**\n\n**Example Flow:**\n- SDR: \"I can schedule your demo for today at 4:30 PM. Reply YES to confirm\"\n- User: \"Will it be recorded?\"\n- SDR: \"Yes, we can record it if you'd like\"\n- User: \"Perfect\"\n- User: \"Yes\" \n→ STILL returns SCHEDULE for 4:30 PM (from the original proposal)\n\n**Reset Conditions (proposal becomes invalid):**\n- User explicitly suggests a DIFFERENT time → New negotiation starts\n- User says \"no\" or explicitly rejects → Proposal cancelled\n- YOU make a NEW time proposal → Supersedes previous proposal\n- User schedules successfully → Previous proposal consumed\n\n## 4. RESPONSE GUIDELINES\n\n### Core Principles:\n1. **Value First**: Answer questions before pushing for demos\n2. **Natural Tone**: Conversational, not scripted\n3. **Mobile Optimized**: Short sentences, line breaks\n4. **Non-Pushy**: Mention scheduling only when relevant\n\n### Message Structure:\n- Start with direct answer to their question\n- Add value or insight\n- Soft scheduling offer ONLY if showing interest\n- Keep under 100 words when possible\n\n### Special Handlers:\n\n**Video Requests:**\n```\n\"Here's a quick demo video: https://www.youtube.com/watch?v=3dBkyvG5Kc8\n\nYou'll see how we automate bank reconciliation and create real-time dashboards. Let me know what questions you have!\"\n```\n\n**Pricing Questions:**\n\nVERY IMPORTANT TO ANSWER THIS EXACT SENTENCE FOR THE PRICING QUESTION AND NOT MENTION ANY SPECIFIC PRICE\n```\n\"Our pricing depends on your transaction volume and number of ledgers. Our account manager can discuss the best plan for you during the demo. Would you like to schedule a quick call?\"\n```\n\n**Competition Mentions (Suvit, Zoho Books, others):**\n\nWhen they mention competitors, acknowledge and differentiate:\n\nFor Suvit specifically:\n\"I understand! Many of our customers switched from Suvit. Here's where AI Accountant excels:\n\n- **Better AI accuracy** - Specifically trained on Indian bank formats\n- **Deeper Tally integration** - Bi-directional sync that actually works\n- **Smarter reconciliation** - Auto-matches complex transactions\n- **Real-time dashboards** - Live P&L, cash flow, AR/AP aging\n- **Indian-first** - Built for GST, TDS, Indian compliance\n\nWhat specific issues are you facing with Suvit?\"\n\nFor generic competitor mentions:\n\"Good to know you're using [tool]. AI Accountant can either replace it entirely or work as a powerful addition, depending on your needs.\n\nOur strengths:\n- 75% reduction in manual bookkeeping\n- AI that learns your business patterns\n- Complete Tally/Zoho automation\n\nWhat's not working well with your current setup?\"\n\n**Too Far in Advance Requests:**\nWhen someone wants to schedule beyond 2 weeks:\n- Gently suggest sooner timing\n- Create urgency without being pushy\n- Offer to follow up closer to their preferred time\n- Maximum booking window: 14 days\n\nExample: \"I can schedule demos up to 2 weeks in advance to ensure we connect while your interest is fresh! How about sometime in the next two weeks?\"\n\n## 5. ESSENTIAL PRODUCT KNOWLEDGE\n\nESSENTIAL PRODUCT KNOWLEDGE\nCompany Context:\nAI Accountant is built by Karbon Card for Indian SMBs and CA firms. We're your digital colleague that thinks like an accountant but works at AI speed.\nCore Value Proposition:\n\"Let your accountant think, we will type.\"\nWe turn messy bank statements into clean, reconciled books with live dashboards—all in minutes, not days.\nKey Capabilities (Use relevant ones based on conversation):\n\n\n\n1. Smart Bank Statement Processing\n\nUpload any format: PDF, Excel, CSV, even photos\nTrained on 50+ Indian bank formats\nExtracts and cleans data automatically\nUse when: They mention manual data entry, bank reconciliation\n\n2. Intelligent Auto-Categorization\n\nAI predicts correct ledger heads\nAuto-assigns GST codes and vendors\nLinks transactions to bills/invoices\nReduces manual work by 75%\nUse when: They talk about categorization, time-saving\n\n3. Seamless Tally/Zoho Integration\n\nPull invoices/bills automatically\nMatch with bank transactions\nPush clean entries back\nStay audit-ready always\nUse when: They use Tally/Zoho, worry about compliance\n\n4. Real-Time Financial Dashboards\n\nP&L, cash flow, runway tracking\nReceivables/payables aging\nVendor and customer analytics\nZero Excel work needed\nUse when: They want visibility, MIS reports\n\n5. Built for Indian Complexity\n\nGST compliant workflows\nTDS handling\nIndian banking formats\nMulti-entity support for groups\nUse when: They mention GST, compliance, Indian-specific needs\n\nTarget Users & Their Pain Points:\nFor CA Firms:\n\nProblem: Managing 20+ clients manually\nSolution: Handle 100+ clients with same team\nBenefit: Premium dashboard service for clients\n\nFor SMB Owners:\n\nProblem: No financial visibility until month-end\nSolution: Daily automated dashboards\nBenefit: Make decisions with real-time data\n\nFor CFOs/Finance Teams:\n\nProblem: Spending 50% time on data entry\nSolution: Automate the grunt work\nBenefit: Focus on analysis and strategy\n\nTrust Indicators:\n\n180+ active customers\n300M+ transactions processed\nISO 27001 & SOC2 Type 2 certified\n50+ CA firms trust us\n\nComing Soon (Only if they ask about future):\n\nDirect bank feeds (no uploads needed)\nGSTN integration for auto-filing\nPredictive cash flow alerts\n\n### Geographic Scope & Limitations\n\n**CRITICAL:** AI Accountant currently serves ONLY Indian businesses and accounts.\n\n**What We Support:**\n- Indian bank accounts and statements (50+ formats)\n- INR currency transactions only\n- Indian GST, TDS, and tax compliance\n- Tally/Zoho Books (Indian versions)\n- Indian business entities and groups\n\n**What We Don't Support:**\n- International bank accounts\n- Foreign currencies (USD, EUR, etc.)\n- Non-Indian compliance requirements\n- International Tally/Zoho setups\n- Cross-border business as primary operations\n\n**When users mention international needs:**\nUse this response pattern: \"AI Accountant is currently built specifically for Indian businesses and bank accounts. If you have Indian operations, I'd love to show you how we can help with those!\"\n\n\n\n## 6. OUTPUT FORMATS\n\n### For SCHEDULING:\nReturn this JSON when user provides specific timing:\n```json\n{\n  \"action\": \"SCHEDULE\",\n  \"title\": \"{{ $json.leadName }} <> AI Accountant Demo\",\n  \"description\": \"30-minute demo covering:\\n\\n• Bank statement automation\\n• Tally/Zoho integration\\n• Live financial dashboards\\n• Your specific use case\\n\\nFeel free to invite teammates who'd benefit.\",\n  \"start_time\": \"<ISO8601 in Asia/Kolkata>\",\n  \"end_time\": \"<start_time + 30 minutes>\",\n  \"attendee_name\": \"{{ $json.leadName }}\",\n  \"attendee_number\": \"{{ $json.leadNumber }}\",\n  \"resume_url\": \"{{ $execution.resumeUrl }}\"\n}\n```\n\n### For UPDATING:\nReturn this JSON when user wants to change existing meeting time:\n```json\n{\n  \"action\": \"UPDATE\",\n  \"title\": \"{{ $json.leadName }} <> AI Accountant Demo\",\n  \"description\": \"30-minute demo covering:\\n\\n• Bank statement automation\\n• Tally/Zoho integration\\n• Live financial dashboards\\n• Your specific use case\\n\\nFeel free to invite teammates who'd benefit.\",\n  \"start_time\": \"<ISO8601 in Asia/Kolkata>\",\n  \"end_time\": \"<start_time + 30 minutes>\",\n  \"attendee_name\": \"{{ $json.leadName }}\",\n  \"attendee_number\": \"{{ $json.leadNumber }}\",\n  \"resume_url\": \"{{ $execution.resumeUrl }}\"\n}\n```\n\n### For RESPONDING:\nReturn this JSON for all other messages:\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"Your response here\\n\\nUse line breaks\\n\\nKeep mobile-friendly\"\n}\n```\n### For ESCALATING:\nReturn this JSON when escalation needed:\n\nCheck current time and adjust message accordingly:\n- **Weekday Working Hours (Mon-Fri 9am-6pm IST)**: Use \"immediately\" or \"within the next few minutes\"\n- **Weekday After Hours (Mon-Thu 6pm-9am)**: Use \"first thing tomorrow morning\"\n- **Weekend Non-Working Hours (Sat-Sun before 9am or after 6pm)**: Use \"first thing in the morning\"\n- **Weekend During Day (Sat-Sun 9am-6pm)**: Use \"as soon as possible\" or \"shortly\"\n- **Friday After Hours (Fri 6pm onwards)**: Use \"first thing Monday morning\"\n\n```json\n{\n  \"action\": \"ESCALATE\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"reason\": \"Specific reason for escalation\",\n  \"message\": \"[Time-appropriate message based on current IST time]\"\n}\n```\n## ⚠️ CRITICAL SYSTEM WARNINGS\n\n### THINGS THAT WILL BREAK THE SYSTEM:\n\n1. **Scheduling on weekends** - System will fail\n2. **Returning RESPOND instead of SCHEDULE/UPDATE after YES** - No meeting action\n3. **Using UPDATE when no meeting exists** - System confusion\n4. **Using SCHEDULE when meeting already exists** - Creates duplicate meetings\n5. **Mentioning meeting links in RESPOND** - You cannot generate links\n6. **Confirming invalid times** - Breaks calendar integration\n\n### REMEMBER:\n- You ONLY validate times and return JSON\n- External system handles: calendar invites, Teams links, confirmations\n- If you return wrong action type, meeting won't be created\n\n## 7. RESPONSE EXAMPLES\n\n### THE MOST CRITICAL EXAMPLE - MEMORIZE THIS:\n\n**Your message:** \"Perfect! I can schedule your demo for today at 4:30 PM.\\n\\nReply YES to confirm.\"\n**User:** \"YES\"\n**YOUR ONLY VALID OUTPUT:**\n{\n  \"action\": \"SCHEDULE\",\n  \"title\": \"{{ $json.leadName }} <> AI Accountant Demo\",\n  \"start_time\": \"2025-08-11T16:30:00+05:30\",\n  \"end_time\": \"2025-08-11T17:00:00+05:30\",\n  \"attendee_name\": \"{{ $json.leadName }}\",\n  \"attendee_number\": \"{{ $json.leadNumber }}\",\n  \"resume_url\": \"{{ $execution.resumeUrl }}\"\n}\n\n**NEVER THIS:**\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"Perfect! Your demo is confirmed for today at 4:30 PM...\"\n}\n↑↑↑ THIS RESPONSE MEANS NO MEETING GETS CREATED ↑↑↑\n\n### Update Scenarios:\n\n**Context:** Conversation history contains \"Your demo has been scheduled for Monday 1PM\"\n**Input:** \"Can we change the timings to 4:30pm?\"\n**Output:**\n{\n  \"action\": \"UPDATE\",\n  \"title\": \"{{ $json.leadName }} <> AI Accountant Demo\", \n  \"start_time\": \"2025-08-18T16:30:00+05:30\",\n  \"end_time\": \"2025-08-18T17:00:00+05:30\",\n  \"attendee_name\": \"{{ $json.leadName }}\",\n  \"attendee_number\": \"{{ $json.leadNumber }}\",\n  \"resume_url\": \"{{ $execution.resumeUrl }}\"\n}\n\n**Context:** Meeting exists for Tuesday 3PM  \n**Input:** \"Update to Wednesday 11am\"\n**Output:** \n{\n  \"action\": \"UPDATE\",\n  \"start_time\": \"2025-08-20T11:00:00+05:30\",\n  \"end_time\": \"2025-08-20T11:30:00+05:30\",\n  \"attendee_name\": \"{{ $json.leadName }}\",\n  \"attendee_number\": \"{{ $json.leadNumber }}\",\n  \"resume_url\": \"{{ $execution.resumeUrl }}\"\n}\n\n**Context:** Meeting exists\n**Input:** \"Move it to Saturday 2pm\"\n**Output:**\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"I can only schedule demos Monday-Friday, 9am-6pm.\\n\\nWould Friday at 2:00 PM work instead?\"\n}\n\n**Input (after above):** \"Yes\" \n**Output:**\n{\n  \"action\": \"UPDATE\",\n  \"start_time\": \"2025-08-22T14:00:00+05:30\",\n  \"end_time\": \"2025-08-22T14:30:00+05:30\",\n  \"attendee_name\": \"{{ $json.leadName }}\",\n  \"attendee_number\": \"{{ $json.leadNumber }}\",\n  \"resume_url\": \"{{ $execution.resumeUrl }}\"\n}\n\n### International Query Examples:\n\n**Input:** \"Can this work for our Mozambique operations?\"\n**Output:**\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"AI Accountant is currently built specifically for Indian businesses and bank accounts.\\n\\nWe support Indian banks, INR transactions, and Indian compliance (GST, TDS).\\n\\nIf you have Indian operations, I'd love to show you how we can help with those!\"\n}\n\n**Input:** \"We have clients in multiple countries\"\n**Output:**\n{\n  \"action\": \"ESCALATE\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"reason\": \"International requirements - outside current scope\",\n  \"message\": \"AI Accountant currently serves Indian businesses specifically.\\n\\nLet me connect you with our team to discuss your requirements and future roadmap.\"\n}\n\n### Scheduling Scenarios:\n\n**Input:** \"Today at 5pm\" (on a Saturday)\n**Output:**\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"I can only schedule demos Monday-Friday, 9am-6pm.\\n\\nSince today is Saturday, would Monday at 5:00 PM work for you?\"\n}\n\n**Input:** \"Tomorrow at 3pm\" (on Sunday, user asking on Saturday)\n**Output:**\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"Tomorrow is Sunday and we only do demos on weekdays.\\n\\nHow about Monday at 3:00 PM instead?\"\n}\n\n**Input:** \"Can we do tomorrow at 3pm?\" (on Thursday)\n**Output:**\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"Perfect! I can schedule your demo for tomorrow (Friday) at 3:00 PM.\\n\\nReply YES to confirm.\"\n}\n\n**Input (after above):** \"Yes\"\n**Output:** \n{\n  \"action\": \"SCHEDULE\",\n  \"title\": \"{{ $json.leadName }} <> AI Accountant Demo\",\n  \"start_time\": \"2025-08-08T15:00:00+05:30\",\n  \"end_time\": \"2025-08-08T15:30:00+05:30\",\n  \"attendee_name\": \"{{ $json.leadName }}\",\n  \"attendee_number\": \"{{ $json.leadNumber }}\",\n  \"resume_url\": \"{{ $execution.resumeUrl }}\"\n}\n// NO CONFIRMATION MESSAGE - System handles this\n\n### CRITICAL Scheduling Confirmation:\n\n**Previous AI message:** \"I can schedule your demo for today at 5:00 PM. Reply YES to confirm\"\n**Input:** \"Yes\"\n**Output:** \n{\n  \"action\": \"SCHEDULE\",\n  \"title\": \"{{ $json.leadName }} <> AI Accountant Demo\",\n  \"start_time\": \"2025-08-07T17:00:00+05:30\",\n  \"end_time\": \"2025-08-07T17:30:00+05:30\",\n  ...\n}\n**NOT THIS:**\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"Demo confirmed...\"  // WRONG - Never send confirmation message\n}\n\n### Too Far in Advance Scenarios:\n\n**Input:** \"Let's schedule for next month\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"I can schedule demos up to 2 weeks in advance to ensure we connect while your interest is fresh!\\n\\nHow about sometime in the next two weeks? What day works best for you?\"\n}\n```\n\n**Input:** \"Can we do a demo in March?\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"That's quite far out! To ensure you get the most current product updates, I schedule demos within the next 2 weeks.\\n\\nWould you prefer next week or the week after?\"\n}\n```\n\n**Input:** \"Schedule it for after Diwali\" (assuming Diwali is 3+ weeks away)\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"I understand you'll be busy with Diwali preparations!\\n\\nHow about we do a quick 15-minute demo before the festivities? Or should I reach out again closer to that time?\"\n}\n```\n\n**Input:** \"Next year would be good\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"That's quite a wait! Our product is evolving rapidly with new features.\\n\\nWhy not see what we can do for you right now? I have slots available this week and next.\\n\\nOr would you prefer I follow up with you in the new year?\"\n}\n```\n\n### Product Questions:\n\n**Input:** \"How does it work with Tally?\"\n**Output:** \n```json\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"AI Accountant syncs directly with Tally!\\n\\nWe pull your invoices and bills, match them with bank transactions automatically, then push clean entries back to Tally.\\n\\nTakes about 5 minutes to set up. Want to see it in action?\"\n}\n```\n\n**Input:** \"Do you handle GST?\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"Yes! We're built for Indian businesses.\\n\\nAI Accountant auto-categorizes GST codes, handles input tax credits, and prepares GSTR-ready reports.\\n\\nWe can show you exactly how it works for your business. What's your typical monthly transaction volume?\"\n}\n```\n\n### Competition Comparisons:\n**Input:** \"How are you better than Suvit?\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"Great question! AI Accountant outperforms Suvit in several ways:\\n\\n• *Accuracy* - Our AI is specifically trained on Indian banks\\n• *Tally Integration* - Seamless bi-directional sync\\n• *Auto-reconciliation* - Matches complex transactions automatically\\n• *Real-time insights* - Live dashboards, not just data entry\\n• *Support* - Dedicated success team\\n\\nWhat challenges are you facing with Suvit currently?\"\n}\n```\n\n**Input:** \"We use Zoho Books\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"Excellent! AI Accountant integrates directly with Zoho Books.\\n\\nWe add intelligence on top:\\n• Auto-categorize bank transactions\\n• Match payments to invoices\\n• Generate dashboards Zoho doesn't provide\\n\\nWe make Zoho Books 10x more powerful. Want to see how?\"\n}\n```\n\n**Input:** \"Using Tally already\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"message\": \"Perfect! AI Accountant is built to supercharge Tally.\\n\\nWe automate everything BEFORE Tally:\\n• Bank statement → AI processing → Clean Tally entries\\n• No manual data entry needed\\n• Your Tally stays clean and audit-ready\\n\\nWhat takes the most time in your Tally workflow currently?\"\n}\n```\n\n### Interest Without Timing:\n\n**Input:** \"Sounds interesting\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"Great to hear! AI Accountant can save you 10+ hours weekly on bookkeeping.\\n\\nWhen would be a good time this week for a quick 15-minute demo? I can show you exactly how it works with your accounting setup.\"\n}\n```\n\n### Objections:\n\n**Input:** \"We're too small for this\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"Actually, AI Accountant is perfect for growing businesses!\\n\\nWe work with companies processing even 100 transactions monthly. The automation helps you stay organized from day one.\\n\\nNo minimum requirements or setup fees. Would you like to see how simple it is?\"\n}\n```\n\n**Input:** \"Not interested\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"No problem at all! If you ever need help automating bookkeeping or getting better financial visibility, we're here.\\n\\nHave a great day!\"\n}\n```\n\n### Escalation Scenarios:\n\n**Input:** \"I need to speak to your manager NOW!\" (at 2:00 PM IST)\n**Output:**\n```json\n{\n  \"action\": \"ESCALATE\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"reason\": \"Customer urgently demanding manager\",\n  \"message\": \"I understand your urgency. Let me connect you with our manager immediately.\\n\\nThey'll call you within the next few minutes.\"\n}\n```\n\n**Input:** \"I need to speak to your manager NOW!\" (at 11:00 PM IST)\n**Output:**\n```json\n{\n  \"action\": \"ESCALATE\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"reason\": \"Customer urgently demanding manager - after hours\",\n  \"message\": \"I understand your concern. Let me connect you with our manager.\\n\\nThey'll get in touch with you first thing tomorrow morning.\"\n}\n```\n\n**Input:** \"Your product is terrible!\" (at 8:00 PM Friday)\n**Output:**\n```json\n{\n  \"action\": \"ESCALATE\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"reason\": \"Angry customer - product complaint\",\n  \"message\": \"I understand your frustration. Let me connect you with our team.\\n\\nThey'll reach out to you as soon as possible to address your concerns.\"\n}\n```\n\n**Input:** \"Your product is a scam!\"\n**Output:**\n```json\n{\n  \"action\": \"ESCALATE\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"reason\": \"Angry customer - potential fraud accusation\",\n  \"message\": \"I understand your concern. Let me connect you with our team immediately.\\n\\nThey'll address this personally.\"\n}\n```\n\n**Input:** \"Can you integrate with our custom SAP ERP?\"\n**Output:**\n```json\n{\n  \"action\": \"ESCALATE\",\n  \"number\": \"{{ $json.leadNumber }}\",\n  \"name\": \"{{ $json.leadName }}\",\n  \"reason\": \"Complex technical integration query\",\n  \"message\": \"That's a great technical question! Our integration team can discuss your specific SAP requirements.\\n\\nThey'll reach out with details.\"\n}\n```\n\n### General Conversation:\n\n**Input:** \"Hi\"\n**Output:**\n```json\n{\n  \"action\": \"RESPOND\",\n  \"message\": \"Hi {{ $json.leadName }}! 👋\\n\\nThanks for your interest in AI Accountant. I saw you requested a demo.\\n\\nWhat's driving your search for accounting automation?\"\n}\n```\n\n## 8. GUARDRAILS\n\n### Never:\n- Make specific price commitments\n- Bash competitors by name\n- Guarantee specific results\n- Share other customer names without permission\n- Send messages over 150 words\n- Use multiple emojis or excessive formatting\n\n### Always:\n- Respond within context of conversation\n- Keep mobile formatting in mind\n- Be helpful even when declining\n- Maintain professional but friendly tone\n- Focus on value, not features\n\n### Escalation Triggers:\n- Return `{\"action\": \"ESCALATE\", \"reason\": \"...\"}` for:\n  - Angry customers\n  - Technical integration details beyond basics\n  - Custom pricing requests\n  - Bug reports or complaints\n  - Legal or compliance questions\n  - International/multi-currency requirements beyond Indian operations\n  - Unclear meeting status when context detection fails\n\n## 9. CRITICAL OUTPUT FORMAT - THIS IS MANDATORY\n\n### ⚠️ MOST COMMON FATAL ERROR ⚠️\nWhen user confirms with YES, you MUST return SCHEDULE/UPDATE not RESPOND.\nReturning RESPOND with \"demo confirmed\" = NO MEETING CREATED = ANGRY CUSTOMER\n\nYOU MUST RETURN ONLY RAW JSON. NOTHING ELSE.\n\nDO NOT INCLUDE:\n- No reasoning or thinking (\"Looking at the request...\")\n- No markdown code blocks (```json)\n- No array wrappers\n- No \"output\" field\n- No explanations before or after\n\nCORRECT OUTPUT EXAMPLES:\n\nFor scheduling - return EXACTLY this format:\n{\n  \"action\": \"SCHEDULE\",\n  \"title\": \"Name <> AI Accountant Demo\",\n  \"description\": \"...\",\n  \"start_time\": \"2025-08-06T22:00:00+05:30\",\n  \"end_time\": \"2025-08-06T22:30:00+05:30\",\n  \"attendee_name\": \"...\",\n  \"attendee_number\": \"...\",\n  \"attendee_email\": \"\",\n  \"sdr_email\": \"\",\n  \"resume_url\": \"...\"\n}\n\nFor updating - return EXACTLY this format:\n{\n  \"action\": \"UPDATE\",\n  \"title\": \"Name <> AI Accountant Demo\",\n  \"description\": \"...\",\n  \"start_time\": \"2025-08-06T22:00:00+05:30\",\n  \"end_time\": \"2025-08-06T22:30:00+05:30\",\n  \"attendee_name\": \"...\",\n  \"attendee_number\": \"...\",\n  \"attendee_email\": \"\",\n  \"sdr_email\": \"\",\n  \"resume_url\": \"...\"\n}\n\nFor responding - return EXACTLY this format:\n{\n  \"action\": \"RESPOND\",\n  \"number\": \"...\",\n  \"name\": \"...\",\n  \"message\": \"...\"\n}\n\nSTART YOUR OUTPUT WITH { AND END WITH }\nNO OTHER CHARACTERS BEFORE OR AFTER THE JSON\nTHIS IS CRITICAL FOR THE SYSTEM TO WORK\n---\n\n**REMEMBER:** You're here to be helpful first, schedule demos second. Every interaction should provide value, whether or not it leads to a demo.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        3904,
        -496
      ],
      "id": "da30a069-f9db-433e-8d26-6757fb78a729",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://hooks.zapier.com/hooks/catch/23651722/uulk799/",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        5648,
        -912
      ],
      "id": "38302c3b-32f5-4eb7-b528-da890b620c69",
      "name": "Trigger - Schedule Meet",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "resume": "webhook",
        "httpMethod": "POST",
        "options": {}
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        5856,
        -912
      ],
      "id": "0d27ba8d-8c1b-4026-a72d-fbbd718e6220",
      "name": "Wait for Teams Link",
      "webhookId": "3a48d7d4-bc39-4c0a-90a3-19e4fcff87c5",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "anthropic/claude-sonnet-4",
          "mode": "list",
          "cachedResultName": "anthropic/claude-sonnet-4"
        },
        "options": {
          "maxTokens": 2000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        3904,
        -256
      ],
      "id": "d7004d89-984f-4b8d-b145-b5da72e47fe0",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "wWLi7dKD19YpkR7l",
          "name": "OpenAi account 7"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Get the AI agent's output string\nconst data = items[0].json.output;\n\nlet parsed;\ntry {\n  // Try to extract JSON from markdown code blocks\n  const jsonMatch = data.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n  if (jsonMatch) {\n    parsed = JSON.parse(jsonMatch[1]);\n  } else {\n    // If no markdown blocks, try to find raw JSON\n    const start = data.indexOf('{');\n    const end = data.lastIndexOf('}');\n    if (start !== -1 && end !== -1) {\n      parsed = JSON.parse(data.substring(start, end + 1));\n    } else {\n      throw new Error(\"No JSON found in output\");\n    }\n  }\n} catch (error) {\n  throw new Error(`Failed to parse JSON: ${error.message}`);\n}\n\n// Return required fields\nreturn [\n  {\n    json: {\n      title: parsed.title,\n      description: parsed.description,\n      start_time: parsed.start_time,\n      end_time: parsed.end_time,\n      attendee_name: parsed.attendee_name,\n      attendee_email: parsed.attendee_email || \"\",\n      attendee_number: parsed.attendee_number,\n      sdr_email: parsed.sdr_email || \"\",\n      resume_url: parsed.resume_url\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4736,
        -896
      ],
      "id": "6b38bbe6-d2a1-49e9-8329-9e3f3de8d84a",
      "name": "Code1"
    },
    {
      "parameters": {
        "jsCode": "const airtable = items[0].json;\nconst ai = items[1].json;\nconst attendeeName = airtable[\"Full Name \"]  || ai.attendee_name || '';\n\nconst webhookPayload = {\n  Title: attendeeName \n    ? `${attendeeName} <> AI Accountant Demo` \n    : (ai.title || 'AI Accountant Demo with SDR'),\n  Description: ai.description || 'Scheduled via WhatsApp reply. SDR to walk through automation features.',\n  \"Start Time\": ai.start_time,\n  \"End Time\": ai.end_time,\n  \"Attendee Name\": ai.attendee_name  ||  airtable[\"Full Name \"] || '',\n  \"Attendee Email\": ai.attendee_email || airtable[\"Lead Email\"] || '',\n  \"Attendee Number\": ai.attendee_number || airtable[\"Number\"] || '',\n  \"Sdr Name\": airtable[\"Deal Owner\"] || '',\n  \"Sdr Number\": airtable[\"Deal Owner Number\"] || '',\n  \"Sdr Email\": airtable[\"Deal Owner Email\"] || ai.sdr_email || '',\n  \"Sdr ID\": airtable[\"Deal Owner ID\"] || '',\n  \"Deal ID\": airtable[\"Deal ID\"] || '',\n  \"Resume Url\": ai.resume_url,\n  \"Additional Attendees\": [\"calls@aiaccountant.co.in\"],\n  querystring: \"\"\n};\n\nreturn [{ json: webhookPayload }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5440,
        -912
      ],
      "id": "eee09000-3184-4cd4-a382-f3ecf2592659",
      "name": "Code2"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "683994411464564",
        "recipientPhoneNumber": "={{ $json.number }}",
        "textBody": "={{ $json.message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        4960,
        -32
      ],
      "id": "96283f28-11bf-4c0a-b91c-47637b13c803",
      "name": "Send General Response",
      "webhookId": "2cfa39a7-3677-4f46-9166-1d7bfa13a031",
      "credentials": {
        "whatsAppApi": {
          "id": "zizchXphgW88Um7w",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// More robust parsing\nconst raw = items[0].json.output;\n\n// Try to extract JSON from the string if it contains extra text\nlet parsed;\ntry {\n  // First try direct parse\n  parsed = JSON.parse(raw);\n} catch (e) {\n  // If that fails, try to extract JSON from markdown blocks\n  const jsonMatch = raw.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n  if (jsonMatch) {\n    parsed = JSON.parse(jsonMatch[1]);\n  } else {\n    // Last resort - find first { and last }\n    const start = raw.indexOf('{');\n    const end = raw.lastIndexOf('}');\n    if (start !== -1 && end !== -1) {\n      parsed = JSON.parse(raw.substring(start, end + 1));\n    } else {\n      throw new Error(\"Could not extract valid JSON from output\");\n    }\n  }\n}\n\nreturn [\n  {\n    json: {\n      name: parsed.name || parsed.attendee_name,\n      message: parsed.message,\n      number: parsed.number || parsed.attendee_number,\n      // Include scheduling fields if present\n      ...(parsed.title && { \n        title: parsed.title,\n        start_time: parsed.start_time,\n        end_time: parsed.end_time\n      })\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4736,
        32
      ],
      "id": "0e534e7f-c3e0-41cb-b3d7-8c3d2f32460b",
      "name": "Code3"
    },
    {
      "parameters": {
        "jsCode": "// Ultra-simple with PROPER sorting by timestamp\n// This ensures chronological order and correct latest message identification\n\n// Debug: log original order\nconsole.log(\"Original items:\", items.map(item => ({\n  timestamp: item.json.Timestamp,\n  message: item.json.Message\n})));\n\n// Sort all items by timestamp (oldest to newest) - FIXED SORTING\nconst sortedItems = items.sort((a, b) => {\n  const timestampA = new Date(a.json.Timestamp).getTime();\n  const timestampB = new Date(b.json.Timestamp).getTime();\n  return timestampA - timestampB;  // Oldest first\n});\n\n// Debug: log sorted order\nconsole.log(\"Sorted items:\", sortedItems.map(item => ({\n  timestamp: item.json.Timestamp,\n  message: item.json.Message\n})));\n\n// Build context string with properly sorted messages (chronological order)\nconst contextString = sortedItems\n  .map((item, index) => {\n    const timestamp = item.json.Timestamp;\n    return `${index + 1}. [${timestamp}] ${item.json.Select === \"Sent\" ? \"SDR\" : \"LEAD\"}: ${item.json.Message}`;\n  })\n  .join('\\n');\n\n// The LAST item in sorted array is the latest message\nconst latestItem = sortedItems[sortedItems.length - 1];\n\nconsole.log(\"Latest message identified:\", {\n  timestamp: latestItem.json.Timestamp,\n  message: latestItem.json.Message\n});\n\n// ============ ADD THESE 10 NEW LINES ============\n// Get current IST date/time\nconst now = new Date();\nconst istString = now.toLocaleString(\"en-US\", {\n  timeZone: \"Asia/Kolkata\",\n  weekday: 'long',\n  year: 'numeric',\n  month: '2-digit',\n  day: '2-digit',\n  hour: '2-digit',\n  minute: '2-digit',\n  hour12: false\n});\n\n// Parse IST string - it has TWO commas: \"Sunday, 08/10/2025, 14:30\"\nconst parts = istString.split(', ');\nconst dayOfWeek = parts[0];\nconst date = parts[1];\nconst time = parts[2];\n\nconst [month, day, year] = date.split('/');\nconst currentDate = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;\nconst currentTime = time.substring(0, 5);\n// ============ END OF NEW LINES ============\n\n// Return data with explicit latest message info\nreturn [{\n  json: {\n    conversationContext: contextString,\n    leadName: latestItem.json.Name,\n    leadNumber: latestItem.json.Number,\n    messageCount: sortedItems.length,\n    latestMessage: latestItem.json.Message,\n    latestTimestamp: latestItem.json.Timestamp,\n    // ADD THESE THREE LINES:\n    currentDate: currentDate,           // e.g., \"2025-08-10\"\n    currentDayOfWeek: dayOfWeek,       // e.g., \"Sunday\"\n    currentTime: currentTime           // e.g., \"14:30\" in IST\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3664,
        -496
      ],
      "id": "73500eae-3fa8-46e3-922b-3b2575a7cd39",
      "name": "Code4"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        5184,
        32
      ],
      "id": "e50fdb56-cb58-4ffd-ad48-1091fc16fbc0",
      "name": "Merge1"
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "filterByFormula": "={Number} = '{{ $json.fields.Number }}'",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        3456,
        -496
      ],
      "id": "f4ea424b-1983-4ad6-891e-7710f08314ce",
      "name": "Search records2",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "filterByFormula": "={Number} = '{{ $json.attendee_number }}'",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        5024,
        -1088
      ],
      "id": "55129553-eae5-44aa-bdb2-4316b579bb8f",
      "name": "Search records3",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        5216,
        -912
      ],
      "id": "97a81aea-54ff-4541-806e-dea36ee51c51",
      "name": "Merge3"
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.number }}",
            "Name": "={{ $json.name }}",
            "Select": "Sent",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{ $json.message }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        5408,
        32
      ],
      "id": "81430af8-9c75-4b07-8c05-b487a07d83ae",
      "name": "Master - WhatsApp First Touch6",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.lead_number }}",
            "Name": "={{ $json.attendee_name }}",
            "Select": "Sent",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{ $json.message }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        6960,
        -1296
      ],
      "id": "ba7840c4-083b-4508-8eed-c912a73a6a69",
      "name": "Master - WhatsApp First Touch7",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "PIs0Ga7Lrny7vTjZ",
          "mode": "list",
          "cachedResultName": "Shyam's Workspace — Whatsapp Outreach Reply Workflow"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        1152,
        416
      ],
      "id": "f1af9487-b606-49c3-94a3-4d46db929934",
      "name": "Execute Workflow"
    },
    {
      "parameters": {
        "content": "# DEMO SCHEDULING WORKFLOW",
        "height": 608,
        "width": 2992,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        4464,
        -1328
      ],
      "typeVersion": 1,
      "id": "53b1d02f-aca2-4b73-a5d3-5bbeba51cb8d",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "# GENERAL RESPONSE",
        "height": 368,
        "width": 1200,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        4464,
        -112
      ],
      "typeVersion": 1,
      "id": "d04017df-0042-425b-8f20-7894db4f17ac",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "683994411464564",
        "recipientPhoneNumber": "={{ $json.sdr_number }}",
        "textBody": "={{ $json.sdr_message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        6464,
        -1136
      ],
      "id": "44dd6cb0-30bb-4b01-85f8-e7662b135c2f",
      "name": "Meet Link to SDR",
      "webhookId": "d66beaf0-6957-436d-8ef3-9819fcb920e6",
      "credentials": {
        "whatsAppApi": {
          "id": "zizchXphgW88Um7w",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "683994411464564",
        "recipientPhoneNumber": "={{ $json.lead_number }}",
        "textBody": "={{ $json.message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        6464,
        -1296
      ],
      "id": "cd9fbff5-60ba-4f24-94ad-85ba423977a7",
      "name": "Meet Link to Lead",
      "webhookId": "2cfa39a7-3677-4f46-9166-1d7bfa13a031",
      "credentials": {
        "whatsAppApi": {
          "id": "zizchXphgW88Um7w",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "content": "# AI SDR",
        "height": 2144,
        "width": 1056,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        3408,
        -1328
      ],
      "typeVersion": 1,
      "id": "bde58aed-83c5-4a71-a830-10b4424f4d74",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "683994411464564",
        "recipientPhoneNumber": "={{ $json.number }}",
        "textBody": "={{ $json.message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        4832,
        336
      ],
      "id": "9865c3b8-4de8-4de7-8aa8-356100d94509",
      "name": "Send General Response1",
      "webhookId": "2cfa39a7-3677-4f46-9166-1d7bfa13a031",
      "credentials": {
        "whatsAppApi": {
          "id": "zizchXphgW88Um7w",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// More robust parsing\nconst raw = items[0].json.output;\n\n// Try to extract JSON from the string if it contains extra text\nlet parsed;\ntry {\n  // First try direct parse\n  parsed = JSON.parse(raw);\n} catch (e) {\n  // If that fails, try to extract JSON from markdown blocks\n  const jsonMatch = raw.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n  if (jsonMatch) {\n    parsed = JSON.parse(jsonMatch[1]);\n  } else {\n    // Last resort - find first { and last }\n    const start = raw.indexOf('{');\n    const end = raw.lastIndexOf('}');\n    if (start !== -1 && end !== -1) {\n      parsed = JSON.parse(raw.substring(start, end + 1));\n    } else {\n      throw new Error(\"Could not extract valid JSON from output\");\n    }\n  }\n}\n\nreturn [\n  {\n    json: {\n      // Common fields\n      name: parsed.name || parsed.attendee_name,\n      message: parsed.message,\n      number: parsed.number || parsed.attendee_number,\n      action: parsed.action,\n      \n      // Include escalation fields if present\n      ...(parsed.reason && { \n        reason: parsed.reason\n      }),\n      \n      // Include scheduling fields if present\n      ...(parsed.title && { \n        title: parsed.title,\n        start_time: parsed.start_time,\n        end_time: parsed.end_time\n      })\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4608,
        400
      ],
      "id": "0bbe4b81-80bf-4b94-b72a-7fd3f5bfbb7c",
      "name": "Code5"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        5056,
        400
      ],
      "id": "eec36266-d3d1-4e9c-aace-647f4338dd9a",
      "name": "Merge4"
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.number }}",
            "Name": "={{ $json.name }}",
            "Select": "Sent",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{ $json.message }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        5296,
        304
      ],
      "id": "06750daf-7c16-4e69-93ef-cf4c975abfd6",
      "name": "Master - WhatsApp First Touch8",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "content": "# ESCALATION",
        "height": 560,
        "width": 1456
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        4464,
        256
      ],
      "typeVersion": 1,
      "id": "ba877088-8faa-4ada-aca1-47ff4c33c232",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "filterByFormula": "={Number} = '{{ $json.number }}'",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        5248,
        592
      ],
      "id": "70130dfd-9ba9-4cbb-954d-0cd5d05d704b",
      "name": "Get SDR Details for Escalation",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const escalation = items[0].json;  // From Merge4\nconst airtable = items[1].json;    // From Airtable search\n\n// Alert message to SDR about escalation\nconst sdrMessage = `⚠️ URGENT ESCALATION ALERT!\\n\\n` +\n  `Customer needs immediate attention:\\n\\n` +\n  `👤 Name: ${escalation.name}\\n` +\n  `📱 Number: ${escalation.number}\\n` +\n  `❗ Reason: ${escalation.reason || 'Customer requested to speak with manager'}\\n\\n` +\n  `Please call them immediately - they are expecting your call!\\n\\n` +\n  `Their last message: \"${escalation.message}\"`;\n\n// Clean SDR number\nconst sdrNumber = airtable[\"Deal Owner Number\"] ? \n  airtable[\"Deal Owner Number\"].replace(/\\D/g, '') : \n  '919999999999';  // Fallback to default\n\nreturn [{\n  json: {\n    sdr_message: sdrMessage,\n    sdr_number: sdrNumber,\n    sdr_name: airtable[\"Deal Owner\"] || 'Sales Team',\n    \n    // Keep original data for logging if needed\n    lead_name: escalation.name,\n    lead_number: escalation.number,\n    escalation_reason: escalation.reason\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5472,
        592
      ],
      "id": "7a42b775-d091-431c-a2d9-194f50b327b2",
      "name": "Format SDR Alert Message"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "683994411464564",
        "recipientPhoneNumber": "={{ $json.sdr_number }}",
        "textBody": "={{ $json.sdr_message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        5696,
        592
      ],
      "id": "8321f57e-ffff-44de-8710-924aea072009",
      "name": "Alert SDR - Escalation",
      "webhookId": "2cfa39a7-3677-4f46-9166-1d7bfa13a031",
      "credentials": {
        "whatsAppApi": {
          "id": "zizchXphgW88Um7w",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://hooks.zapier.com/hooks/catch/23651722/u6d7fmg/",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        7232,
        -880
      ],
      "id": "bea84459-8139-4b63-a16d-ec29cc07166f",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblZpcZwRwnPZUF4o",
          "mode": "list",
          "cachedResultName": "Demo Scheduled by AI SDR",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblZpcZwRwnPZUF4o"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Name": "={{ $json.attendee_name }}",
            "Number": "={{ $json.lead_number }}",
            "SDR": "={{ $json.sdr_name }}",
            "Demo Scheduled": "={{ $json.formatted_date }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "SDR",
              "displayName": "SDR",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Demo Scheduled",
              "displayName": "Demo Scheduled",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Demo_Date_Only",
              "displayName": "Demo_Date_Only",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Reminder Sent",
              "displayName": "Reminder Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Rescheduled",
              "displayName": "Rescheduled",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        6960,
        -1120
      ],
      "id": "8284655f-7a7b-4109-934f-49781aab5b41",
      "name": "Demo Scheduled Update",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "filterByFormula": "={Number} = '{{ $json.lead_number }}'",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        6768,
        -880
      ],
      "id": "db38ad51-b921-4bcb-84b9-ec6053ff1087",
      "name": "Search records",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "\n// Get Deal ID & SDR ID from Code\nconst dealId = $node[\"Code\"].json.deal_id;    // ← Use deal_id (lowercase)\nconst sdrId = $node[\"Code\"].json.sdr_id;      // ← Use sdr_id (lowercase)\n\n// Get all messages from Airtable search\nconst messages = items;\n\n// Sort messages by timestamp\nconst sortedMessages = messages.sort((a, b) => {\n  return new Date(a.json.Timestamp) - new Date(b.json.Timestamp);\n});\n\n// Get lead info from messages\nconst leadName = sortedMessages[0]?.json.Name || 'Unknown';\nconst leadNumber = sortedMessages[0]?.json.Number || '';\n\n// Extract demo info from messages\nlet demoScheduled = null;\nlet meetingLink = null;\nlet sdrName = null;\n\nsortedMessages.forEach(msg => {\n  if (msg.json.Message.includes('demo for AI Accountant has been scheduled')) {\n    const dateMatch = msg.json.Message.match(/scheduled for (.+?)\\. We're/);\n    if (dateMatch) demoScheduled = dateMatch[1];\n    \n    const sdrMatch = msg.json.Message.match(/From here on, (.+?) will be/);\n    if (sdrMatch) sdrName = sdrMatch[1];\n    \n    const linkMatch = msg.json.Message.match(/(https:\\/\\/teams\\.microsoft\\.com[^\\s]+)/);\n    if (linkMatch) meetingLink = linkMatch[1];\n  }\n});\n\n// Calculate stats\nconst leadMessages = sortedMessages.filter(m => m.json.Select === 'Received').length;\nconst aiMessages = sortedMessages.filter(m => m.json.Select === 'Sent').length;\n\n// Helper function to create section headers with lines\nfunction createHeader(text) {\n  const totalLength = 102;\n  const remainingDashes = totalLength - text.length - 2; // -2 for spaces\n  return text + ' ' + '-'.repeat(remainingDashes);\n}\n\n// Full line separator\nconst fullLine = '-'.repeat(102);\n\n// Build note\nlet noteBody = 'AI SDR WHATSAPP CONVERSATION\\r\\n';\nnoteBody += fullLine + '\\r\\n\\r\\n';\n\nnoteBody += createHeader('LEAD INFORMATION') + '\\r\\n';\nnoteBody += 'Name: ' + leadName + '\\r\\n';\nnoteBody += 'Phone: ' + leadNumber + '\\r\\n';\nnoteBody += 'Deal ID: ' + (dealId || 'N/A') + '\\r\\n';\nnoteBody += 'SDR ID: ' + (sdrId || 'N/A') + '\\r\\n';\nnoteBody += 'Total Messages: ' + sortedMessages.length + '\\r\\n\\r\\n';\n\n// Demo section if found\nif (demoScheduled) {\n  noteBody += createHeader('DEMO SCHEDULED') + '\\r\\n';\n  noteBody += 'Date/Time: ' + demoScheduled + '\\r\\n';\n  if (sdrName) noteBody += 'SDR: ' + sdrName + '\\r\\n';\n  if (meetingLink) noteBody += 'Meeting Link: ' + meetingLink + '\\r\\n\\r\\n';\n}\n\nnoteBody += createHeader('CONVERSATION HISTORY') + '\\r\\n\\r\\n';\n\nsortedMessages.forEach((msg) => {\n  const isAISDR = msg.json.Select === 'Sent';\n  const sender = isAISDR ? 'AI SDR' : (msg.json.Name || 'Lead');\n  \n  noteBody += sender + ':\\r\\n';\n  noteBody += msg.json.Message + '\\r\\n\\r\\n';\n});\n\nnoteBody += createHeader('SUMMARY') + '\\r\\n';\nnoteBody += 'Lead Messages: ' + leadMessages + '\\r\\n';\nnoteBody += 'AI SDR Messages: ' + aiMessages + '\\r\\n';\nnoteBody += 'Outcome: ' + (demoScheduled ? 'Demo successfully scheduled' : 'Conversation in progress') + '\\r\\n\\r\\n';\n\nnoteBody += fullLine + '\\r\\n';\nnoteBody += 'Note generated: ' + new Date().toLocaleString('en-IN', {timeZone: 'Asia/Kolkata'}) + '\\r\\n';\nnoteBody += 'Source: AI SDR WhatsApp System';\n\n// Return payload\nreturn [{\n  json: {\n    note_body: noteBody,\n    lead_name: leadName,\n    lead_number: leadNumber,\n    total_messages: sortedMessages.length,\n    lead_messages: leadMessages,\n    ai_messages: aiMessages,\n    demo_scheduled: demoScheduled,\n    meet_url: meetingLink,\n    created_at: new Date().toISOString(),\n    source: 'AI_SDR_WhatsApp',\n\n    // Newly added from Code\n    deal_id: dealId,\n    sdr_id: sdrId\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6992,
        -880
      ],
      "id": "d9050464-1b68-4744-9248-41fcbd835902",
      "name": "Code7"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        6576,
        -880
      ],
      "id": "03ca5238-13f2-4ad8-8c66-f8ac6495c210",
      "name": "Wait",
      "webhookId": "8ecdb91a-907c-45cd-aa83-d0807c869dac",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const data = item.json;\nconst dealId = $node[\"Code2\"].json[\"Deal ID\"];  // Fetch directly from Code2\nconst sdrId = $node[\"Code2\"].json[\"Deal Owner ID\"];\n\n// Format date\nconst start = new Date(data.start_time);\nconst options = {\n  weekday: 'long',\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric',\n  hour: 'numeric',\n  minute: '2-digit',\n  hour12: true,\n  timeZone: 'Asia/Kolkata'\n};\nconst formattedDate = start.toLocaleString('en-IN', options);\n\n// Clean SDR number\nconst cleanSdrNumber = data.sdr_number.replace(/\\D/g, '');\n\n// Message to Attendee\nconst message = `Hey! Your demo for *AI Accountant* has been scheduled for *${formattedDate}*. We're excited to show you what we've built! 🚀\n\nYou can join the session using this link:\n👉 ${data.meet_url}\n\nFrom here on, *${data.sdr_name}* will be your point of contact throughout your AI Accountant journey. Feel free to reach out at *${cleanSdrNumber}* if you have any questions.\n\nLooking forward to our session! 😊`;\n\n// Message to SDR\nconst sdrMessage = `Hey ${data.sdr_name},\n\nA demo has been scheduled for *${data.attendee_name}* on *${formattedDate}*.\n📌 POC: ${data.attendee_name}\n🔗 Meeting Link: ${data.meet_url}\n\nPlease check your calendar and ensure you're available for the session.\n\nThanks!`;\n\nreturn {\n  json: {\n    // Attendee WhatsApp\n    message,\n    lead_number: data.lead_number,\n\n    // SDR WhatsApp\n    sdr_name: data.sdr_name,\n    sdr_message: sdrMessage,\n    sdr_number: cleanSdrNumber,\n    sdr_id: sdrId,  // <-- fetched from Code2\n\n    // For Airtable logging\n    start_time: data.start_time,\n    formatted_date: formattedDate,\n  \n    meet_url: data.meet_url,\n    attendee_name: data.attendee_name,\n    deal_id: dealId  // Now includes Deal ID from Code2\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6288,
        -912
      ],
      "id": "81a95e4d-df87-43f3-91be-0cdfa9841ace",
      "name": "Code"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "40837d24-31f0-4e67-8f11-668d40e8b245",
              "name": "meet_url",
              "value": "={{ $json.body.teams_url }}",
              "type": "string"
            },
            {
              "id": "1ed550d6-e5f8-4fdf-b679-50136a989ec8",
              "name": "start_time",
              "value": "={{ $json.body.start_time }}",
              "type": "string"
            },
            {
              "id": "0b6818e6-0600-4ec9-854c-ad11609a981b",
              "name": "sdr_name",
              "value": "={{ $json.body.sdr_name }}",
              "type": "string"
            },
            {
              "id": "34743d8e-6395-469d-b2a2-fca9b4290862",
              "name": "sdr_number",
              "value": "={{ $json.body.sdr_number }}",
              "type": "string"
            },
            {
              "id": "edde3fe4-b053-4a05-a6d5-ece6b4dce99c",
              "name": "lead_number",
              "value": "={{ $json.body.lead_number }}",
              "type": "string"
            },
            {
              "id": "8e410e54-0301-46b3-94a0-8976cc576a61",
              "name": "attendee_name",
              "value": "={{ $json.body.attendee_name }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        6080,
        -304
      ],
      "id": "151574f7-3a15-4d60-a488-5e3d0fe5e376",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://hooks.zapier.com/hooks/catch/23651722/u63ayck/",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ $json }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        5648,
        -304
      ],
      "id": "b08df4de-2cd5-457d-8016-1ec19383df36",
      "name": "Trigger - Schedule Meet1",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "resume": "webhook",
        "httpMethod": "POST",
        "options": {}
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        5856,
        -304
      ],
      "id": "958042d8-bfaa-4b67-a9e2-a6b425281b8c",
      "name": "Wait for Teams Link1",
      "webhookId": "3a48d7d4-bc39-4c0a-90a3-19e4fcff87c5",
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "jsCode": "// Get the AI agent's output string\nconst data = items[0].json.output;\n\nlet parsed;\ntry {\n  // Try to extract JSON from markdown code blocks\n  const jsonMatch = data.match(/```json\\s*([\\s\\S]*?)\\s*```/);\n  if (jsonMatch) {\n    parsed = JSON.parse(jsonMatch[1]);\n  } else {\n    // If no markdown blocks, try to find raw JSON\n    const start = data.indexOf('{');\n    const end = data.lastIndexOf('}');\n    if (start !== -1 && end !== -1) {\n      parsed = JSON.parse(data.substring(start, end + 1));\n    } else {\n      throw new Error(\"No JSON found in output\");\n    }\n  }\n} catch (error) {\n  throw new Error(`Failed to parse JSON: ${error.message}`);\n}\n\n// Return required fields\nreturn [\n  {\n    json: {\n      title: parsed.title,\n      description: parsed.description,\n      start_time: parsed.start_time,\n      end_time: parsed.end_time,\n      attendee_name: parsed.attendee_name,\n      attendee_email: parsed.attendee_email || \"\",\n      attendee_number: parsed.attendee_number,\n      sdr_email: parsed.sdr_email || \"\",\n      resume_url: parsed.resume_url\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4736,
        -288
      ],
      "id": "733c23e3-d967-43f2-b03c-b5b6944a61d5",
      "name": "Code6"
    },
    {
      "parameters": {
        "jsCode": "const airtable = items[0].json;\nconst ai = items[1].json;\nconst attendeeName = airtable[\"Full Name \"]  || ai.attendee_name || '';\n\nconst webhookPayload = {\n  Title: attendeeName \n    ? `${attendeeName} <> AI Accountant Demo` \n    : (ai.title || 'AI Accountant Demo with SDR'),\n  Description: ai.description || 'Scheduled via WhatsApp reply. SDR to walk through automation features.',\n  \"Start Time\": ai.start_time,\n  \"End Time\": ai.end_time,\n  \"Attendee Name\": ai.attendee_name ||  airtable[\"Full Name \"] || '',\n  \"Attendee Email\": ai.attendee_email || airtable[\"Lead Email\"] || '',\n  \"Attendee Number\": ai.attendee_number || airtable[\"Number\"] || '',\n  \"Sdr Name\": airtable[\"Deal Owner\"] || '',\n  \"Sdr Number\": airtable[\"Deal Owner Number\"] || '',\n  \"Sdr Email\": airtable[\"Deal Owner Email\"] || ai.sdr_email || '',\n  \"Sdr ID\": airtable[\"Deal Owner ID\"] || '',\n  \"Deal ID\": airtable[\"Deal ID\"] || '',\n  \"Resume Url\": ai.resume_url,\n  \"Additional Attendees\": [\"calls@aiaccountant.co.in\"],\n  querystring: \"\"\n};\n\nreturn [{ json: webhookPayload }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5440,
        -304
      ],
      "id": "073f59f2-25ca-480d-8b64-ca71c714df2a",
      "name": "Code8"
    },
    {
      "parameters": {
        "operation": "search",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblGQRaqljlapDPAD",
          "mode": "list",
          "cachedResultName": "Sent - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblGQRaqljlapDPAD"
        },
        "filterByFormula": "={Number} = '{{ $json.attendee_number }}'",
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        5024,
        -480
      ],
      "id": "abdd01ee-da82-4710-b76a-3c6e121da294",
      "name": "Search records4",
      "alwaysOutputData": true,
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        5216,
        -304
      ],
      "id": "f7f3d93b-2144-45a4-8018-d733029b85cf",
      "name": "Merge5"
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblqy0QyBGNPnBtFg",
          "mode": "list",
          "cachedResultName": "Master - Whatsapp First Touch",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblqy0QyBGNPnBtFg"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Number": "={{ $json.lead_number }}",
            "Name": "={{ $json.attendee_name }}",
            "Select": "Sent",
            "Timestamp": "={{ $now.setZone('Asia/Kolkata').format('DD HH:mm:ss') }}",
            "Message": "={{ $json.message }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Message",
              "displayName": "Message",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Select",
              "displayName": "Select",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Received",
                  "value": "Received"
                },
                {
                  "name": "Sent",
                  "value": "Sent"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "SENT",
                  "value": "SENT"
                },
                {
                  "name": "DELIVERED",
                  "value": "DELIVERED"
                },
                {
                  "name": "READ",
                  "value": "READ"
                },
                {
                  "name": "REPLIED",
                  "value": "REPLIED"
                },
                {
                  "name": "FAILED",
                  "value": "FAILED"
                },
                {
                  "name": "UNDELIVERABLE",
                  "value": "UNDELIVERABLE"
                },
                {
                  "name": "",
                  "value": ""
                }
              ],
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        6960,
        -480
      ],
      "id": "5078491a-dd3e-46e1-96b5-6ad048f52ab5",
      "name": "Master - WhatsApp First Touch9",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "683994411464564",
        "recipientPhoneNumber": "={{ $json.sdr_number }}",
        "textBody": "={{ $json.sdr_message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        6528,
        -464
      ],
      "id": "413796e9-f7ae-416e-8a69-90e1505bcc23",
      "name": "Meet Link to SDR1",
      "webhookId": "d66beaf0-6957-436d-8ef3-9819fcb920e6",
      "credentials": {
        "whatsAppApi": {
          "id": "zizchXphgW88Um7w",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "683994411464564",
        "recipientPhoneNumber": "={{ $json.lead_number }}",
        "textBody": "={{ $json.message }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        6528,
        -656
      ],
      "id": "4a6b2e9f-7948-4db9-83e6-437137fd1c52",
      "name": "Meet Link to Lead1",
      "webhookId": "2cfa39a7-3677-4f46-9166-1d7bfa13a031",
      "credentials": {
        "whatsAppApi": {
          "id": "zizchXphgW88Um7w",
          "name": "WhatsApp account"
        }
      }
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "app4Ga3V7xw90ZvaU",
          "mode": "list",
          "cachedResultName": "Whatsapp - Master Base",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU"
        },
        "table": {
          "__rl": true,
          "value": "tblZpcZwRwnPZUF4o",
          "mode": "list",
          "cachedResultName": "Demo Scheduled by AI SDR",
          "cachedResultUrl": "https://airtable.com/app4Ga3V7xw90ZvaU/tblZpcZwRwnPZUF4o"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Name": "={{ $json.attendee_name }}",
            "Number": "={{ $json.lead_number }}",
            "SDR": "={{ $json.sdr_name }}",
            "Demo Scheduled": "={{ $json.formatted_date }}",
            "Rescheduled": "Yes"
          },
          "matchingColumns": [
            "Number"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Number",
              "displayName": "Number",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "SDR",
              "displayName": "SDR",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Demo Scheduled",
              "displayName": "Demo Scheduled",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Demo_Date_Only",
              "displayName": "Demo_Date_Only",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": true
            },
            {
              "id": "Reminder Sent",
              "displayName": "Reminder Sent",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Rescheduled",
              "displayName": "Rescheduled",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        6960,
        -304
      ],
      "id": "3c685630-b639-4f3f-9450-232d8bfec3cd",
      "name": "Demo Scheduled Update1",
      "credentials": {
        "airtableTokenApi": {
          "id": "Er63oAf0XfghX3Ic",
          "name": "Airtable Personal Access Token account 2"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const data = item.json;\nconst dealId = $node[\"Code8\"].json[\"Deal ID\"];  // Fetch directly from Code2\nconst sdrId = $node[\"Code8\"].json[\"Deal Owner ID\"];\n\n// Format date\nconst start = new Date(data.start_time);\nconst options = {\n  weekday: 'long',\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric',\n  hour: 'numeric',\n  minute: '2-digit',\n  hour12: true,\n  timeZone: 'Asia/Kolkata'\n};\nconst formattedDate = start.toLocaleString('en-IN', options);\n\n// Clean SDR number\nconst cleanSdrNumber = data.sdr_number.replace(/\\D/g, '');\n\n// Message to Attendee\nconst message = `Hey! Your demo for *AI Accountant* has been re-scheduled for *${formattedDate}*. We're excited to show you what we've built! 🚀\n\nYou can join the session using this link:\n👉 ${data.meet_url}\n\nFrom here on, *${data.sdr_name}* will be your point of contact throughout your AI Accountant journey. Feel free to reach out at *${cleanSdrNumber}* if you have any questions.\n\nLooking forward to our session! 😊`;\n\n// Message to SDR\nconst sdrMessage = `Hey ${data.sdr_name},\n\nA demo has been re-scheduled for *${data.attendee_name}* on *${formattedDate}*.\n📌 POC: ${data.attendee_name}\n🔗 Meeting Link: ${data.meet_url}\n\nPlease check your calendar and ensure you're available for the session.\n\nThanks!`;\n\nreturn {\n  json: {\n    // Attendee WhatsApp\n    message,\n    lead_number: data.lead_number,\n\n    // SDR WhatsApp\n    sdr_name: data.sdr_name,\n    sdr_message: sdrMessage,\n    sdr_number: cleanSdrNumber,\n    sdr_id: sdrId,  // <-- fetched from Code2\n\n    // For Airtable logging\n    start_time: data.start_time,\n    formatted_date: formattedDate,\n  \n    meet_url: data.meet_url,\n    attendee_name: data.attendee_name,\n    deal_id: dealId  // Now includes Deal ID from Code2\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6288,
        -304
      ],
      "id": "29563212-10a9-4bf9-92d8-e69919447948",
      "name": "Code10"
    },
    {
      "parameters": {
        "content": "# DEMO RE-SCHEDULING WORKFLOW",
        "height": 608,
        "width": 2992,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        4464,
        -720
      ],
      "typeVersion": 1,
      "id": "4b54be7f-6e2d-4575-9b98-bc406aaf6fc4",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "SCHEDULE",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "156ad665-b405-45dd-bd75-2f76d87fc4d7"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "16ab3a1d-b507-4cf3-abe7-d793f4502a1b",
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "UPDATE",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "de7f540b-b15d-446e-8b9a-25b9164c9b28",
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "RESPOND",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "a2502d1f-2a52-4513-8a54-1d461b1baf61",
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "ESACALATE",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        4256,
        -512
      ],
      "id": "060583c3-d95c-433f-808a-f72397bbcded",
      "name": "Switch"
    }
  ],
  "pinData": {
    "Webhook": [
      {
        "json": {
          "headers": {
            "host": "aiacc.app.n8n.cloud",
            "user-agent": "facebookexternalua",
            "content-length": "483",
            "accept": "*/*",
            "accept-encoding": "gzip, br",
            "cdn-loop": "cloudflare; loops=1; subreqs=1",
            "cf-connecting-ip": "2a03:2880:22ff:9::",
            "cf-ew-via": "15",
            "cf-ipcountry": "US",
            "cf-ray": "9716c7cdd4f4e608-IAD",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "cf-worker": "n8n.cloud",
            "content-type": "application/json",
            "x-forwarded-for": "2a03:2880:22ff:9::, 172.71.191.92",
            "x-forwarded-host": "aiacc.app.n8n.cloud",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "traefik-prod-users-gwc-40-669b86c79-rhnjz",
            "x-hub-signature": "sha1=cf11ac550a662da7c182bf78b4165b38dde74ae1",
            "x-hub-signature-256": "sha256=ef6351d8520ff09ea23db55424f84dffb6de03f9347b22b40e1c0d24a342d770",
            "x-is-trusted": "yes",
            "x-real-ip": "2a03:2880:22ff:9::"
          },
          "params": {},
          "query": {},
          "body": {
            "object": "whatsapp_business_account",
            "entry": [
              {
                "id": "1212058303572940",
                "changes": [
                  {
                    "value": {
                      "messaging_product": "whatsapp",
                      "metadata": {
                        "display_phone_number": "919008770403",
                        "phone_number_id": "683994411464564"
                      },
                      "contacts": [
                        {
                          "profile": {
                            "name": "CA Vikas Gupta"
                          },
                          "wa_id": "918708581173"
                        }
                      ],
                      "messages": [
                        {
                          "from": "918708581173",
                          "id": "wamid.HBgMOTE4NzA4NTgxMTczFQIAEhgWM0VCMDIzQUU3QzFBNzVFMTU4NDlFOQA=",
                          "timestamp": "1755576408",
                          "text": {
                            "body": "11 AM"
                          },
                          "type": "text"
                        }
                      ]
                    },
                    "field": "messages"
                  }
                ]
              }
            ]
          },
          "webhookUrl": "https://aiacc.app.n8n.cloud/webhook/ac5e2f21-bde4-477b-8889-26b827cbec66",
          "executionMode": "production"
        }
      }
    ]
  },
  "connections": {
    "Respond to Webhook": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          },
          {
            "node": "Search records1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "If - First Touch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search records1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Reply - Whatsapp First Touch": {
      "main": [
        [
          {
            "node": "Search records2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If \"FAILED\"2": {
      "main": [
        [
          {
            "node": "If RESEND2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If \"READ\"2": {
      "main": [
        [
          {
            "node": "Update READ2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master - WhatsApp First Touch2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If \"DELIVERED\"2": {
      "main": [
        [
          {
            "node": "Update DELIVERED2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master - WhatsApp First Touch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If \"SENT\"2": {
      "main": [
        [
          {
            "node": "Update SENT2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master - WhatsApp First Touch5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Status Details2": {
      "main": [
        [
          {
            "node": "If \"READ\"2",
            "type": "main",
            "index": 0
          },
          {
            "node": "If \"DELIVERED\"2",
            "type": "main",
            "index": 0
          },
          {
            "node": "If \"SENT\"2",
            "type": "main",
            "index": 0
          },
          {
            "node": "If \"FAILED\"2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Message Data2": {
      "main": [
        [
          {
            "node": "Master - WhatsApp First Touch",
            "type": "main",
            "index": 0
          },
          {
            "node": "Reply - Whatsapp First Touch",
            "type": "main",
            "index": 0
          },
          {
            "node": "Sent - Whatsapp First Touch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If - Message or Status2": {
      "main": [
        [
          {
            "node": "Extract Message Data2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extract Status Details2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If RESEND2": {
      "main": [
        [
          {
            "node": "Update FAILED2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master - WhatsApp First Touch3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If UNDELIVERABLE2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If UNDELIVERABLE2": {
      "main": [
        [
          {
            "node": "Update FAILED3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master - WhatsApp First Touch4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If - First Touch": {
      "main": [
        [
          {
            "node": "If - Message or Status2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Execute Workflow",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger - Schedule Meet": {
      "main": [
        [
          {
            "node": "Wait for Teams Link",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait for Teams Link": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "Search records3",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code2": {
      "main": [
        [
          {
            "node": "Trigger - Schedule Meet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send General Response": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code3": {
      "main": [
        [
          {
            "node": "Send General Response",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code4": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Master - WhatsApp First Touch6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search records2": {
      "main": [
        [
          {
            "node": "Code4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search records3": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "Code2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Meet Link to SDR": {
      "main": [
        []
      ]
    },
    "Meet Link to Lead": {
      "main": [
        []
      ]
    },
    "Send General Response1": {
      "main": [
        [
          {
            "node": "Merge4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code5": {
      "main": [
        [
          {
            "node": "Send General Response1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge4",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge4": {
      "main": [
        [
          {
            "node": "Master - WhatsApp First Touch8",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get SDR Details for Escalation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get SDR Details for Escalation": {
      "main": [
        [
          {
            "node": "Format SDR Alert Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format SDR Alert Message": {
      "main": [
        [
          {
            "node": "Alert SDR - Escalation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Master - WhatsApp First Touch7": {
      "main": [
        []
      ]
    },
    "Search records": {
      "main": [
        [
          {
            "node": "Code7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Search records",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code7": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          },
          {
            "node": "Meet Link to Lead",
            "type": "main",
            "index": 0
          },
          {
            "node": "Meet Link to SDR",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master - WhatsApp First Touch7",
            "type": "main",
            "index": 0
          },
          {
            "node": "Demo Scheduled Update",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Code10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger - Schedule Meet1": {
      "main": [
        [
          {
            "node": "Wait for Teams Link1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait for Teams Link1": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code6": {
      "main": [
        [
          {
            "node": "Search records4",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge5",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Code8": {
      "main": [
        [
          {
            "node": "Trigger - Schedule Meet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search records4": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge5": {
      "main": [
        [
          {
            "node": "Code8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code10": {
      "main": [
        [
          {
            "node": "Meet Link to Lead1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Meet Link to SDR1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Master - WhatsApp First Touch9",
            "type": "main",
            "index": 0
          },
          {
            "node": "Demo Scheduled Update1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "92561352-2aa9-43aa-8fae-02217fdbe1f4",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "45745a8adebf972591cb1c34947d7982ccae58966ae55502975d349f81f9d3fe"
  },
  "id": "fn8yqhvRd2nmz3K1",
  "tags": []
}